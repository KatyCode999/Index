<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <title>üîê Calculadora del teu √∫s d'Internet</title>
  <style>
    body {
      background-image: url("https://lh3.googleusercontent.com/d/1tiQcChb9SFam7PooNmLmfKJ30HrsAJJv");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
    }

    h1 {
      color: #ffffff;
      margin-top: 30px;
      background-color: #0400ff9d;
      border-radius: 100px;
      padding: 20px 30px;
      text-align: center;
    }

    label {
      display: block;
      margin: 30px 0 5px;
      color: #ffffff;
      margin-left: 470px;
    }

    input, select {
      width: 300px;
      padding: 6px;
      margin-bottom: 10px;
      color: #000000;
      margin-right: 30px;
    }

    button {
      margin-top: 30px;
      padding: 30px 30px;
      background: #0400ff4f;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 100px;
      display: block;
      margin-left: 500px;
    }

    .result {
      margin-top: 20px;
      font-weight: bold;
      padding: 15px;
      border-radius: 6px;
    }

    .high { background-color: #d4edda; color: #155724; }
    .medium { background-color: #fff3cd; color: #856404; }
    .low { background-color: #f8d7da; color: #721c24; }

    select {
      color: #ffffff;
      background: linear-gradient(45deg, rgba(4, 0, 255, 0.719), rgba(0, 255, 242, 0.616));
      margin-left: 470px;
    }

    input {
      color: #ffffff;
      background: linear-gradient(45deg, rgba(4, 0, 255, 0.719), rgba(0, 255, 242, 0.616));
      margin-left: 470px;
    }

    option {
      background-color: #000000;
      color: #ffffff;
    }
  </style>
</head>
<body>
  <h1>üîê Calculadora del teu √∫s d'Internet</h1>
  <form id="securityForm">
    <label>1Ô∏è‚É£ Durant quant de temps utilitzes Internet di√†riament (hores)?</label>
    <input type="number" id="internetUse" min="1" required>

    <label>2Ô∏è‚É£ Tens un antivirus instal¬∑lat?</label>
    <select id="antivirus">
      <option value="">-- Selecciona --</option>
      <option value="si">S√≠</option>
      <option value="no">No</option>
      <option value="no ho s√©">No ho s√©</option>
    </select>

    <label>3Ô∏è‚É£ Surts del teu compte d'Internet?</label>
    <select id="logout">
      <option value="">-- Selecciona --</option>
      <option value="si">S√≠</option>
      <option value="no">No</option>
    </select>

    <label>4Ô∏è‚É£ Has experimentat alguna amena√ßa?</label>
    <select id="threat">
      <option value="">-- Selecciona --</option>
      <option value="no">No</option>
      <option value="1-2">1-2 vegades</option>
      <option value="3-4">3-4 vegades</option>
      <option value="5+">5 o m√©s</option>
    </select>

    <label>5Ô∏è‚É£ Introdueix una contrasenya que creguis que √©s segura:</label>
    <input type="text" id="password" required>

    <label>6Ô∏è‚É£ Tens xarxes socials?</label>
    <select id="hasSocialMedia">
      <option value="">-- Selecciona --</option>
      <option value="si">S√≠</option>
      <option value="no">No</option>
    </select>

    <div id="accountTypeContainer" style="display:none;">
      <label>Quin tipus de compte tens?</label>
      <select id="accountType">
        <option value="">-- Selecciona --</option>
        <option value="public">P√∫blic</option>
        <option value="private">Privat</option>
      </select>
    </div>

    <label>7Ô∏è‚É£ Saps qu√® √©s el 2FA?</label>
    <select id="knows2fa">
      <option value="">-- Selecciona --</option>
      <option value="no">No</option>
      <option value="si">S√≠</option>
    </select>

    <div id="2faDetails" style="display:none;">
      <label>Quants comptes actius tens?</label>
      <input type="number" id="totalAccounts" min="1">

      <label>En quants tens activat el 2FA?</label>
      <input type="number" id="enabled2fa" min="0">
    </div>

    <button type="submit">Comprova la meva seguretat</button>
  </form>

  <div id="result" class="result"></div>

<script>
  const form = document.getElementById("securityForm");
  const knows2fa = document.getElementById("knows2fa");
  const hasSocialMedia = document.getElementById("hasSocialMedia");
  const accountTypeContainer = document.getElementById("accountTypeContainer");
  const resultBox = document.getElementById("result");

  const COMMON_PASSWORDS = [/* ... truncated for brevity ... */];

  function isSecurePassword(pw) {
    return (
      pw.length >= 12 &&
      /[A-Z]/.test(pw) &&
      /[a-z]/.test(pw) &&
      /\d/.test(pw) &&
      /[!@#$%^&*(),.?":{}|<>]/.test(pw) &&
      !COMMON_PASSWORDS.includes(pw.toLowerCase())
    );
  }

  knows2fa.addEventListener("change", () => {
    document.getElementById("2faDetails").style.display = knows2fa.value === "si" ? "block" : "none";
  });

  hasSocialMedia.addEventListener("change", () => {
    accountTypeContainer.style.display = hasSocialMedia.value === "si" ? "block" : "none";
  });

  form.addEventListener("submit", function (e) {
    e.preventDefault();

    const H = parseInt(document.getElementById("internetUse").value);
    const rH = H / 2;
    const antivirus = document.getElementById("antivirus").value;
    const logout = document.getElementById("logout").value;
    const threat = document.getElementById("threat").value;
    const password = document.getElementById("password").value;
    const hasSocial = hasSocialMedia.value;
    const knows = knows2fa.value;

    let rS = antivirus === "si" ? 22.2 : 0;
    let rU = logout === "si" ? 11.1 : 0;

    let rA = 0;
    if (threat === "no") rA = 22.2;
    else if (threat === "1-2") rA = 11.1;
    else if (threat === "3-4") rA = 5.55;
    else if (threat === "5+") rA = 0;

    let rC = isSecurePassword(password) ? 22.2 : 0;

    let rR = 0;
    if (hasSocial === "no") {
      rR = 11.1;
    } else if (hasSocial === "si") {
      const accType = document.getElementById("accountType").value;
      if (accType === "private") rR = 5.55;
      else if (accType === "public") rR = 0;
      else {
        alert("Si tens xarxes socials, cal indicar si el compte √©s p√∫blic o privat.");
        return;
      }
    }

    let rTFA = 0;
    if (knows === "si") {
      const total = parseInt(document.getElementById("totalAccounts").value);
      const enabled = parseInt(document.getElementById("enabled2fa").value);
      if (isNaN(total) || total <= 0 || isNaN(enabled) || enabled < 0 || enabled > total) {
        alert("Comptes actius o 2FA no v√†lids.");
        return;
      }
      rTFA = Math.min((enabled / total) * 22.2, 22.2);
    }

    const raw_score = rS + rU + rA + rC + rR + rTFA;

    let score;
    if (rC === 0) {
      score = raw_score - 10;
    } else {
      score = Math.min((raw_score / (rH * 0.5)), 100);
    }

    score = Math.max(score, 0);
    score = Math.round(score * 100) / 100;

    let message = "", style = "";

    if (score >= 90) {
      message = "üéâ Excel¬∑lent! Tens molt bona seguretat digital. Mantens pr√†ctiques saludables com tenir contrasenyes fortes, fer servir 2FA i evitar comptes socials p√∫blics. Continua aix√≠!";
      style = "high";
    } else if (score >= 60) {
      message = "üîê Bona feina! La teva seguretat √©s for√ßa bona, per√≤ hi ha √†rees per millorar. Revisa si tens contrasenyes prou segures, activa el 2FA als comptes principals i assegura't que les teves xarxes socials s√≥n privades.";
      style = "medium";
    } else if (score >= 30) {
      message = "‚ö†Ô∏è Compte! Hi ha diverses √†rees en qu√® la teva seguretat pot millorar: potser tens contrasenyes d√®bils, no utilitzes antivirus, no tancar les sessions o tens comptes socials p√∫blics. Fes una revisi√≥!";
      style = "medium";
    } else {
      message = "üö® Molt baix! La teva seguretat digital √©s molt preocupant. Segurament no tens contrasenyes segures, ni antivirus, ni coneixes el 2FA, i has estat exposat a amenaces. Et recomanem revisar totes les teves pr√†ctiques digitals immediatament.";
      style = "low";
    }

    resultBox.className = "result " + style;
    resultBox.innerHTML = `üîí La teva seguretat a Internet √©s del <strong>${score}%</strong><br>${message}`;

    // Envia el resultat al full de c√†lcul
    fetch("https://script.google.com/macros/s/AKfycbx6pYeM0Iun7Fxb8rphCE_TPF4lp3-6NBbm_dCC9fZJoUwTHDAZeAn8Q7wj6Q8eAQhyyA/exec", {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: `score=${encodeURIComponent(score)}`
    })
    .then(response => response.text())
    .then(data => {
      console.log("Success:", data);
    })
    .catch(error => {
      console.error("Error:", error);
    });
  });
</script>
</body>
</html>
